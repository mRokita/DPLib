

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Getting Started &mdash; DPLib 1.5 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="README" href="includeme.html" />
    <link rel="prev" title="LICENSE" href="includelicense.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> DPLib
          

          
          </a>

          
            
            
              <div class="version">
                1.5
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="includelicense.html">LICENSE</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Getting Started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="#installation">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#first-steps">First steps</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#available-event-handlers">Available event handlers</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#waiting-for-future-events">Waiting for future events</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#available-coroutines">Available coroutines</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#examples">Examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#map-settings">Map settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="#map-elim-script">Map elim script</a></li>
<li class="toctree-l3"><a class="reference internal" href="#spawnkill-message">Spawnkill message</a></li>
<li class="toctree-l3"><a class="reference internal" href="#streak">Streak</a></li>
<li class="toctree-l3"><a class="reference internal" href="#server-manager">Server manager</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="includeme.html">README</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">DPLib</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Getting Started</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/gettingstarted.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="getting-started">
<h1>Getting Started<a class="headerlink" href="#getting-started" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>DPLib is a Python library that makes you able to write scripts that react on some in-game events</p>
</div>
<div class="section" id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h2>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>git clone https://github.com/mRokita/DPLib.git
<span class="nb">cd</span> DPLib
python3 -m pip install DPLib <span class="c1"># Only python 3 is supported</span>
</pre></div>
</div>
</div>
<div class="section" id="first-steps">
<h2>First steps<a class="headerlink" href="#first-steps" title="Permalink to this headline">¶</a></h2>
<p>This code is a basic example of how to use DPLib. It uses all the currently available events.
You should definitely play around with it. Simply edit the third line to match your server’s config and run it!</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># DPLib - Asynchronous bot framework for Digital Paint: Paintball 2 servers</span>
<span class="c1"># Copyright (C) 2017  Michał Rokita</span>
<span class="c1">#</span>
<span class="c1"># This program is free software: you can redistribute it and/or modify</span>
<span class="c1"># it under the terms of the GNU Affero General Public License as published by</span>
<span class="c1"># the Free Software Foundation, either version 3 of the License, or</span>
<span class="c1"># (at your option) any later version.</span>
<span class="c1">#</span>
<span class="c1"># This program is distributed in the hope that it will be useful,</span>
<span class="c1"># but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="c1"># MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="c1"># GNU Affero General Public License for more details.</span>
<span class="c1">#</span>
<span class="c1"># You should have received a copy of the GNU Affero General Public License</span>
<span class="c1"># along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>

<span class="kn">from</span> <span class="nn">dplib.server</span> <span class="k">import</span> <span class="n">Server</span>


<span class="n">s</span> <span class="o">=</span> <span class="n">Server</span><span class="p">(</span><span class="n">hostname</span><span class="o">=</span><span class="s1">&#39;127.0.0.1&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">27910</span><span class="p">,</span> <span class="n">logfile</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;C:\Games\Paintball2\pball\qconsole27910.log&#39;</span><span class="p">,</span> <span class="n">rcon_password</span><span class="o">=</span><span class="s1">&#39;hello&#39;</span><span class="p">)</span>


<span class="nd">@s</span><span class="o">.</span><span class="n">event</span>
<span class="k">def</span> <span class="nf">on_chat</span><span class="p">(</span><span class="n">nick</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Chat message. Nick: </span><span class="si">{0}</span><span class="s1">, Message: </span><span class="si">{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">nick</span><span class="p">,</span> <span class="n">message</span><span class="p">))</span>


<span class="nd">@s</span><span class="o">.</span><span class="n">event</span>
<span class="k">def</span> <span class="nf">on_team_switched</span><span class="p">(</span><span class="n">nick</span><span class="p">,</span> <span class="n">old_team</span><span class="p">,</span> <span class="n">new_team</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Team switched. Nick: </span><span class="si">{0}</span><span class="s1">, Old team: </span><span class="si">{1}</span><span class="s1">, New team: </span><span class="si">{2}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">nick</span><span class="p">,</span> <span class="n">old_team</span><span class="p">,</span> <span class="n">new_team</span><span class="p">))</span>


<span class="nd">@s</span><span class="o">.</span><span class="n">event</span>
<span class="k">def</span> <span class="nf">on_round_started</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Round started...&#39;</span><span class="p">)</span>


<span class="nd">@s</span><span class="o">.</span><span class="n">event</span>
<span class="k">def</span> <span class="nf">on_elim</span><span class="p">(</span><span class="n">killer_nick</span><span class="p">,</span> <span class="n">killer_weapon</span><span class="p">,</span> <span class="n">victim_nick</span><span class="p">,</span> <span class="n">victim_weapon</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Elimination. Killer</span><span class="se">\&#39;</span><span class="s1">s nick: </span><span class="si">{0}</span><span class="s1">, Killer</span><span class="se">\&#39;</span><span class="s1">s weapon: </span><span class="si">{1}</span><span class="s1">, Victim</span><span class="se">\&#39;</span><span class="s1">s nick: </span><span class="si">{2}</span><span class="s1">, Victim</span><span class="se">\&#39;</span><span class="s1">s weapon: </span><span class="si">{3}</span><span class="s1">&#39;</span>
        <span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="n">killer_nick</span><span class="p">,</span> <span class="n">killer_weapon</span><span class="p">,</span> <span class="n">victim_nick</span><span class="p">,</span> <span class="n">victim_weapon</span>
    <span class="p">))</span>


<span class="nd">@s</span><span class="o">.</span><span class="n">event</span>
<span class="k">def</span> <span class="nf">on_respawn</span><span class="p">(</span><span class="n">team</span><span class="p">,</span> <span class="n">nick</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Respawn. Nick: </span><span class="si">{0}</span><span class="s1">, Team: </span><span class="si">{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">nick</span><span class="p">,</span> <span class="n">team</span><span class="p">))</span>


<span class="nd">@s</span><span class="o">.</span><span class="n">event</span>
<span class="k">def</span> <span class="nf">on_entrance</span><span class="p">(</span><span class="n">nick</span><span class="p">,</span> <span class="n">build</span><span class="p">,</span> <span class="n">addr</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Entrance. Nick: </span><span class="si">{0}</span><span class="s1">, Build: </span><span class="si">{1}</span><span class="s1">, Address: </span><span class="si">{2}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="n">nick</span><span class="p">,</span> <span class="n">build</span><span class="p">,</span> <span class="n">addr</span>
    <span class="p">))</span>


<span class="nd">@s</span><span class="o">.</span><span class="n">event</span>
<span class="k">def</span> <span class="nf">on_elim_teams_flag</span><span class="p">(</span><span class="n">team</span><span class="p">,</span> <span class="n">nick</span><span class="p">,</span> <span class="n">points</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Points for posession of eliminated teams flag. Team: </span><span class="si">{0}</span><span class="s1">, Nick: </span><span class="si">{1}</span><span class="s1">, Points: </span><span class="si">{2}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="n">team</span><span class="p">,</span> <span class="n">nick</span><span class="p">,</span> <span class="n">points</span>
    <span class="p">))</span>


<span class="nd">@s</span><span class="o">.</span><span class="n">event</span>
<span class="k">def</span> <span class="nf">on_flag_captured</span><span class="p">(</span><span class="n">team</span><span class="p">,</span> <span class="n">nick</span><span class="p">,</span> <span class="n">flag</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Flag captured. Team: </span><span class="si">{0}</span><span class="s1">, Nick: </span><span class="si">{1}</span><span class="s1">, Flag: </span><span class="si">{2}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">team</span><span class="p">,</span> <span class="n">nick</span><span class="p">,</span> <span class="n">flag</span><span class="p">))</span>


<span class="nd">@s</span><span class="o">.</span><span class="n">event</span>
<span class="k">def</span> <span class="nf">on_game_end</span><span class="p">(</span><span class="n">score_blue</span><span class="p">,</span> <span class="n">score_red</span><span class="p">,</span> <span class="n">score_yellow</span><span class="p">,</span> <span class="n">score_purple</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Game ended. Blue:</span><span class="si">{}</span><span class="s1"> Red:</span><span class="si">{}</span><span class="s1"> Yellow:</span><span class="si">{}</span><span class="s1"> Purple:</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="n">score_blue</span><span class="p">,</span> <span class="n">score_red</span><span class="p">,</span> <span class="n">score_yellow</span><span class="p">,</span> <span class="n">score_purple</span>
    <span class="p">))</span>


<span class="nd">@s</span><span class="o">.</span><span class="n">event</span>
<span class="k">def</span> <span class="nf">on_mapchange</span><span class="p">(</span><span class="n">mapname</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Map changed. Mapname: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mapname</span><span class="p">))</span>


<span class="nd">@s</span><span class="o">.</span><span class="n">event</span>
<span class="k">def</span> <span class="nf">on_namechange</span><span class="p">(</span><span class="n">old_nick</span><span class="p">,</span> <span class="n">new_nick</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Name changed. Old nick: </span><span class="si">{}</span><span class="s1"> New nick: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">old_nick</span><span class="p">,</span> <span class="n">new_nick</span><span class="p">))</span>


<span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">get_status</span><span class="p">())</span>
<span class="n">s</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
<div class="section" id="available-event-handlers">
<h3>Available event handlers<a class="headerlink" href="#available-event-handlers" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p><a class="reference internal" href="source/dplib.html#dplib.server.Server.on_elim" title="dplib.server.Server.on_elim"><code class="xref py py-func docutils literal notranslate"><span class="pre">dplib.server.Server.on_elim()</span></code></a></p></li>
<li><p><a class="reference internal" href="source/dplib.html#dplib.server.Server.on_entrance" title="dplib.server.Server.on_entrance"><code class="xref py py-func docutils literal notranslate"><span class="pre">dplib.server.Server.on_entrance()</span></code></a></p></li>
<li><p><a class="reference internal" href="source/dplib.html#dplib.server.Server.on_respawn" title="dplib.server.Server.on_respawn"><code class="xref py py-func docutils literal notranslate"><span class="pre">dplib.server.Server.on_respawn()</span></code></a></p></li>
<li><p><a class="reference internal" href="source/dplib.html#dplib.server.Server.on_elim_teams_flag" title="dplib.server.Server.on_elim_teams_flag"><code class="xref py py-func docutils literal notranslate"><span class="pre">dplib.server.Server.on_elim_teams_flag()</span></code></a></p></li>
<li><p><a class="reference internal" href="source/dplib.html#dplib.server.Server.on_team_switched" title="dplib.server.Server.on_team_switched"><code class="xref py py-func docutils literal notranslate"><span class="pre">dplib.server.Server.on_team_switched()</span></code></a></p></li>
<li><p><a class="reference internal" href="source/dplib.html#dplib.server.Server.on_round_started" title="dplib.server.Server.on_round_started"><code class="xref py py-func docutils literal notranslate"><span class="pre">dplib.server.Server.on_round_started()</span></code></a></p></li>
<li><p><a class="reference internal" href="source/dplib.html#dplib.server.Server.on_flag_captured" title="dplib.server.Server.on_flag_captured"><code class="xref py py-func docutils literal notranslate"><span class="pre">dplib.server.Server.on_flag_captured()</span></code></a></p></li>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">dplib.server.Server.on_message()</span></code></p></li>
<li><p><a class="reference internal" href="source/dplib.html#dplib.server.Server.on_game_end" title="dplib.server.Server.on_game_end"><code class="xref py py-func docutils literal notranslate"><span class="pre">dplib.server.Server.on_game_end()</span></code></a></p></li>
<li><p><a class="reference internal" href="source/dplib.html#dplib.server.Server.on_mapchange" title="dplib.server.Server.on_mapchange"><code class="xref py py-func docutils literal notranslate"><span class="pre">dplib.server.Server.on_mapchange()</span></code></a></p></li>
<li><p><a class="reference internal" href="source/dplib.html#dplib.server.Server.on_namechange" title="dplib.server.Server.on_namechange"><code class="xref py py-func docutils literal notranslate"><span class="pre">dplib.server.Server.on_namechange()</span></code></a></p></li>
</ul>
</div>
</div>
<div class="section" id="waiting-for-future-events">
<h2>Waiting for future events<a class="headerlink" href="#waiting-for-future-events" title="Permalink to this headline">¶</a></h2>
<p>DPLib uses Python’s asyncio module so you can wait for incoming events without blocking the whole script.</p>
<p>Here’s a script that uses these ‘magic’ coroutines.</p>
<p>It’s a simple spawnkill protection system, it waits for 2 seconds after respawn for elimination event and when the newly respawned player gets killed within these 2 seconds, the spawnkiller gets a warning. After 4 spawnkills she/he gets kicked from the server.</p>
<p>Check out the 10th line.</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># DPLib - Asynchronous bot framework for Digital Paint: Paintball 2 servers</span>
<span class="c1"># Copyright (C) 2017  Michał Rokita</span>
<span class="c1">#</span>
<span class="c1"># This program is free software: you can redistribute it and/or modify</span>
<span class="c1"># it under the terms of the GNU Affero General Public License as published by</span>
<span class="c1"># the Free Software Foundation, either version 3 of the License, or</span>
<span class="c1"># (at your option) any later version.</span>
<span class="c1">#</span>
<span class="c1"># This program is distributed in the hope that it will be useful,</span>
<span class="c1"># but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="c1"># MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="c1"># GNU Affero General Public License for more details.</span>
<span class="c1">#</span>
<span class="c1"># You should have received a copy of the GNU Affero General Public License</span>
<span class="c1"># along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>

<span class="kn">from</span> <span class="nn">time</span> <span class="k">import</span> <span class="n">time</span>

<span class="kn">from</span> <span class="nn">dplib.server</span> <span class="k">import</span> <span class="n">Server</span>

<span class="n">s</span> <span class="o">=</span> <span class="n">Server</span><span class="p">(</span><span class="n">hostname</span><span class="o">=</span><span class="s1">&#39;127.0.0.1&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">27910</span><span class="p">,</span> <span class="n">logfile</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;C:\Games\Paintball2\pball\qconsole27910.log&#39;</span><span class="p">,</span> <span class="n">rcon_password</span><span class="o">=</span><span class="s1">&#39;hello&#39;</span><span class="p">)</span>

<span class="n">spawnkills</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="n">spawnkill_last_times</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

<span class="nd">@s</span><span class="o">.</span><span class="n">event</span>
<span class="k">def</span> <span class="nf">on_respawn</span><span class="p">(</span><span class="n">team</span><span class="p">,</span> <span class="n">nick</span><span class="p">):</span>
    <span class="n">kill</span> <span class="o">=</span> <span class="k">yield from</span> <span class="n">s</span><span class="o">.</span><span class="n">wait_for_elim</span><span class="p">(</span><span class="n">victim_nick</span><span class="o">=</span><span class="n">nick</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">kill</span><span class="p">:</span>
        <span class="k">return</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">kill</span><span class="p">[</span><span class="s1">&#39;killer_nick&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">spawnkills</span> <span class="ow">or</span> <span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">spawnkill_last_times</span><span class="p">[</span><span class="n">kill</span><span class="p">[</span><span class="s1">&#39;killer_nick&#39;</span><span class="p">]]</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">:</span>
        <span class="n">spawnkills</span><span class="p">[</span><span class="n">kill</span><span class="p">[</span><span class="s1">&#39;killer_nick&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">spawnkills</span><span class="p">[</span><span class="n">kill</span><span class="p">[</span><span class="s1">&#39;killer_nick&#39;</span><span class="p">]]</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="n">spawnkill_last_times</span><span class="p">[</span><span class="n">kill</span><span class="p">[</span><span class="s1">&#39;killer_nick&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
    <span class="n">s</span><span class="o">.</span><span class="n">say</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{C}</span><span class="s1">9</span><span class="si">%s</span><span class="s1">, </span><span class="si">{C}</span><span class="s1">A</span><span class="si">{U}</span><span class="s1">STOP SPAWNKILLING</span><span class="si">{U}</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">kill</span><span class="p">[</span><span class="s1">&#39;killer_nick&#39;</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">spawnkills</span><span class="p">[</span><span class="n">kill</span><span class="p">[</span><span class="s1">&#39;killer_nick&#39;</span><span class="p">]]</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">:</span>
        <span class="n">s</span><span class="o">.</span><span class="n">kick</span><span class="p">(</span><span class="n">nick</span><span class="o">=</span><span class="n">kill</span><span class="p">[</span><span class="s1">&#39;killer_nick&#39;</span><span class="p">])</span>
<span class="n">s</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
<div class="section" id="available-coroutines">
<h3>Available coroutines<a class="headerlink" href="#available-coroutines" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p><a class="reference internal" href="source/dplib.html#dplib.server.Server.wait_for_elim" title="dplib.server.Server.wait_for_elim"><code class="xref py py-func docutils literal notranslate"><span class="pre">dplib.server.Server.wait_for_elim()</span></code></a></p></li>
<li><p><a class="reference internal" href="source/dplib.html#dplib.server.Server.wait_for_entrance" title="dplib.server.Server.wait_for_entrance"><code class="xref py py-func docutils literal notranslate"><span class="pre">dplib.server.Server.wait_for_entrance()</span></code></a></p></li>
<li><p><a class="reference internal" href="source/dplib.html#dplib.server.Server.wait_for_respawn" title="dplib.server.Server.wait_for_respawn"><code class="xref py py-func docutils literal notranslate"><span class="pre">dplib.server.Server.wait_for_respawn()</span></code></a></p></li>
<li><p><a class="reference internal" href="source/dplib.html#dplib.server.Server.wait_for_elim_teams_flag" title="dplib.server.Server.wait_for_elim_teams_flag"><code class="xref py py-func docutils literal notranslate"><span class="pre">dplib.server.Server.wait_for_elim_teams_flag()</span></code></a></p></li>
<li><p><a class="reference internal" href="source/dplib.html#dplib.server.Server.wait_for_team_switched" title="dplib.server.Server.wait_for_team_switched"><code class="xref py py-func docutils literal notranslate"><span class="pre">dplib.server.Server.wait_for_team_switched()</span></code></a></p></li>
<li><p><a class="reference internal" href="source/dplib.html#dplib.server.Server.wait_for_round_started" title="dplib.server.Server.wait_for_round_started"><code class="xref py py-func docutils literal notranslate"><span class="pre">dplib.server.Server.wait_for_round_started()</span></code></a></p></li>
<li><p><a class="reference internal" href="source/dplib.html#dplib.server.Server.wait_for_flag_captured" title="dplib.server.Server.wait_for_flag_captured"><code class="xref py py-func docutils literal notranslate"><span class="pre">dplib.server.Server.wait_for_flag_captured()</span></code></a></p></li>
<li><p><a class="reference internal" href="source/dplib.html#dplib.server.Server.wait_for_message" title="dplib.server.Server.wait_for_message"><code class="xref py py-func docutils literal notranslate"><span class="pre">dplib.server.Server.wait_for_message()</span></code></a></p></li>
<li><p><a class="reference internal" href="source/dplib.html#dplib.server.Server.wait_for_game_end" title="dplib.server.Server.wait_for_game_end"><code class="xref py py-func docutils literal notranslate"><span class="pre">dplib.server.Server.wait_for_game_end()</span></code></a></p></li>
<li><p><a class="reference internal" href="source/dplib.html#dplib.server.Server.wait_for_mapchange" title="dplib.server.Server.wait_for_mapchange"><code class="xref py py-func docutils literal notranslate"><span class="pre">dplib.server.Server.wait_for_mapchange()</span></code></a></p></li>
<li><p><a class="reference internal" href="source/dplib.html#dplib.server.Server.wait_for_namechange" title="dplib.server.Server.wait_for_namechange"><code class="xref py py-func docutils literal notranslate"><span class="pre">dplib.server.Server.wait_for_namechange()</span></code></a></p></li>
</ul>
</div>
</div>
<div class="section" id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h2>
<div class="section" id="map-settings">
<h3>Map settings<a class="headerlink" href="#map-settings" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># DPLib - Asynchronous bot framework for Digital Paint: Paintball 2 servers</span>
<span class="c1"># Copyright (C) 2017  Michał Rokita</span>
<span class="c1">#</span>
<span class="c1"># This program is free software: you can redistribute it and/or modify</span>
<span class="c1"># it under the terms of the GNU Affero General Public License as published by</span>
<span class="c1"># the Free Software Foundation, either version 3 of the License, or</span>
<span class="c1"># (at your option) any later version.</span>
<span class="c1">#</span>
<span class="c1"># This program is distributed in the hope that it will be useful,</span>
<span class="c1"># but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="c1"># MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="c1"># GNU Affero General Public License for more details.</span>
<span class="c1">#</span>
<span class="c1"># You should have received a copy of the GNU Affero General Public License</span>
<span class="c1"># along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<span class="kn">from</span> <span class="nn">asyncio</span> <span class="k">import</span> <span class="n">sleep</span>

<span class="kn">from</span> <span class="nn">dplib.server</span> <span class="k">import</span> <span class="n">Server</span>

<span class="n">s</span> <span class="o">=</span> <span class="n">Server</span><span class="p">(</span><span class="n">hostname</span><span class="o">=</span><span class="s1">&#39;127.0.0.1&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">27911</span><span class="p">,</span> <span class="n">logfile</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;C:\Games\Paintball2\pball\qconsole27911.log&#39;</span><span class="p">,</span> <span class="n">rcon_password</span><span class="o">=</span><span class="s1">&#39;hello&#39;</span><span class="p">)</span>

<span class="n">map_settings</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;airtime&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;command&#39;</span><span class="p">:</span> <span class="s1">&#39;set elim 10;set timelimit 10;&#39;</span><span class="p">,</span>
        <span class="s1">&#39;message&#39;</span><span class="p">:</span> <span class="s1">&#39;</span><span class="si">{C}</span><span class="s1">9Special settings for airtime </span><span class="si">{C}</span><span class="s1">Aenabled&#39;</span>
    <span class="p">},</span>
    <span class="s1">&#39;shazam33&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;command&#39;</span><span class="p">:</span> <span class="s1">&#39;set elim 10;set timelimit 10;&#39;</span><span class="p">,</span>
        <span class="s1">&#39;message&#39;</span><span class="p">:</span> <span class="s1">&#39;</span><span class="si">{C}</span><span class="s1">9Special settings for shazam33 </span><span class="si">{C}</span><span class="s1">Aenabled&#39;</span>
    <span class="p">},</span>
    <span class="s1">&#39;default_settings&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;command&#39;</span><span class="p">:</span> <span class="s1">&#39;set elim 20;set timelimit 20;&#39;</span><span class="p">,</span>
        <span class="s1">&#39;message&#39;</span><span class="p">:</span> <span class="s1">&#39;</span><span class="si">{C}</span><span class="s1">9No special settings for map </span><span class="si">{I}</span><span class="s1">&lt;mapname&gt;</span><span class="si">{I}</span><span class="s1">, using defaults&#39;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="nd">@s</span><span class="o">.</span><span class="n">event</span>
<span class="k">def</span> <span class="nf">on_mapchange</span><span class="p">(</span><span class="n">mapname</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">mapname</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">map_settings</span><span class="p">:</span>
        <span class="n">settings</span> <span class="o">=</span> <span class="n">map_settings</span><span class="p">[</span><span class="s1">&#39;default_settings&#39;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">settings</span> <span class="o">=</span> <span class="n">map_settings</span><span class="p">[</span><span class="n">mapname</span><span class="p">]</span>
    <span class="n">command</span> <span class="o">=</span> <span class="n">settings</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;command&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">message</span> <span class="o">=</span> <span class="n">settings</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;message&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">message</span><span class="p">:</span>
        <span class="n">message</span> <span class="o">=</span> <span class="n">mapname</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">message</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;&lt;mapname&gt;&#39;</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">command</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">command</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">):</span>
            <span class="n">s</span><span class="o">.</span><span class="n">rcon</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">message</span><span class="p">:</span>
        <span class="k">yield from</span> <span class="n">sleep</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">s</span><span class="o">.</span><span class="n">say</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>

<span class="n">s</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="map-elim-script">
<h3>Map elim script<a class="headerlink" href="#map-elim-script" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># DPLib - Asynchronous bot framework for Digital Paint: Paintball 2 servers</span>
<span class="c1"># Copyright (C) 2017  Michał Rokita</span>
<span class="c1">#</span>
<span class="c1"># This program is free software: you can redistribute it and/or modify</span>
<span class="c1"># it under the terms of the GNU Affero General Public License as published by</span>
<span class="c1"># the Free Software Foundation, either version 3 of the License, or</span>
<span class="c1"># (at your option) any later version.</span>
<span class="c1">#</span>
<span class="c1"># This program is distributed in the hope that it will be useful,</span>
<span class="c1"># but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="c1"># MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="c1"># GNU Affero General Public License for more details.</span>
<span class="c1">#</span>
<span class="c1"># You should have received a copy of the GNU Affero General Public License</span>
<span class="c1"># along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>

<span class="kn">from</span> <span class="nn">dplib.server</span> <span class="k">import</span> <span class="n">Server</span>

<span class="n">s</span> <span class="o">=</span> <span class="n">Server</span><span class="p">(</span><span class="n">hostname</span><span class="o">=</span><span class="s1">&#39;127.0.0.1&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">27910</span><span class="p">,</span> <span class="n">logfile</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;C:\Games\Paintball2\pball\qconsole27910.log&#39;</span><span class="p">,</span> <span class="n">rcon_password</span><span class="o">=</span><span class="s1">&#39;hello&#39;</span><span class="p">)</span>

<span class="n">elim_active</span> <span class="o">=</span> <span class="kc">False</span>

<span class="nd">@s</span><span class="o">.</span><span class="n">event</span>
<span class="k">def</span> <span class="nf">on_chat</span><span class="p">(</span><span class="n">nick</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">elim_active</span>
    <span class="k">if</span> <span class="n">message</span> <span class="o">==</span> <span class="s1">&#39;!map elim&#39;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">elim_active</span><span class="p">:</span>
        <span class="n">elim_active</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">maps</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;beta/wobluda_fix&#39;</span><span class="p">,</span> <span class="s1">&#39;beta/daylight_b1&#39;</span><span class="p">,</span> <span class="s1">&#39;airtime&#39;</span><span class="p">]</span>
        <span class="n">s</span><span class="o">.</span><span class="n">say</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{C}</span><span class="s1">AType </span><span class="se">\&#39;</span><span class="s1">!elim &lt;mapname&gt;</span><span class="se">\&#39;</span><span class="s1"> to eliminate a map.&#39;</span><span class="p">)</span>
        <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">maps</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">s</span><span class="o">.</span><span class="n">say</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{C}</span><span class="s1">9Available maps: &#39;</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">maps</span><span class="p">))</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="k">yield from</span> <span class="n">s</span><span class="o">.</span><span class="n">wait_for_message</span><span class="p">(</span><span class="n">check</span><span class="o">=</span><span class="k">lambda</span> <span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">:</span> <span class="n">m</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;!elim &#39;</span><span class="p">))</span>
            <span class="n">mapname</span> <span class="o">=</span> <span class="n">msg</span><span class="p">[</span><span class="s1">&#39;message&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;!elim &#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">mapname</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">maps</span><span class="p">:</span>
                <span class="n">s</span><span class="o">.</span><span class="n">say</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{C}</span><span class="s1">9Invalid map.&#39;</span><span class="p">)</span>
                <span class="n">s</span><span class="o">.</span><span class="n">say</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{C}</span><span class="s1">9Available maps: &#39;</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">maps</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">maps</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">mapname</span><span class="p">)</span>
        <span class="n">s</span><span class="o">.</span><span class="n">rcon</span><span class="p">(</span><span class="s1">&#39;sv newmap &#39;</span><span class="o">+</span><span class="n">maps</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">elim_active</span> <span class="o">=</span> <span class="kc">False</span>

<span class="n">s</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="spawnkill-message">
<h3>Spawnkill message<a class="headerlink" href="#spawnkill-message" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># DPLib - Asynchronous bot framework for Digital Paint: Paintball 2 servers</span>
<span class="c1"># Copyright (C) 2017  Michał Rokita</span>
<span class="c1">#</span>
<span class="c1"># This program is free software: you can redistribute it and/or modify</span>
<span class="c1"># it under the terms of the GNU Affero General Public License as published by</span>
<span class="c1"># the Free Software Foundation, either version 3 of the License, or</span>
<span class="c1"># (at your option) any later version.</span>
<span class="c1">#</span>
<span class="c1"># This program is distributed in the hope that it will be useful,</span>
<span class="c1"># but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="c1"># MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="c1"># GNU Affero General Public License for more details.</span>
<span class="c1">#</span>
<span class="c1"># You should have received a copy of the GNU Affero General Public License</span>
<span class="c1"># along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>

<span class="kn">from</span> <span class="nn">dplib.server</span> <span class="k">import</span> <span class="n">Server</span>

<span class="n">s</span> <span class="o">=</span> <span class="n">Server</span><span class="p">(</span><span class="n">hostname</span><span class="o">=</span><span class="s1">&#39;127.0.0.1&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">27910</span><span class="p">,</span> <span class="n">logfile</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;C:\Games\Paintball2\pball\qconsole27910.log&#39;</span><span class="p">,</span> <span class="n">rcon_password</span><span class="o">=</span><span class="s1">&#39;hello&#39;</span><span class="p">)</span>

<span class="nd">@s</span><span class="o">.</span><span class="n">event</span>
<span class="k">def</span> <span class="nf">on_respawn</span><span class="p">(</span><span class="n">team</span><span class="p">,</span> <span class="n">nick</span><span class="p">):</span>
    <span class="n">kill</span> <span class="o">=</span> <span class="k">yield from</span> <span class="n">s</span><span class="o">.</span><span class="n">wait_for_elim</span><span class="p">(</span><span class="n">victim_nick</span><span class="o">=</span><span class="n">nick</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">kill</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">get_ingame_info</span><span class="p">(</span><span class="n">kill</span><span class="p">[</span><span class="s1">&#39;killer_nick&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">dplogin</span><span class="p">)</span>
        <span class="n">s</span><span class="o">.</span><span class="n">say</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{C}</span><span class="s1">9</span><span class="si">%s</span><span class="s1">, </span><span class="si">{C}</span><span class="s1">A</span><span class="si">{U}</span><span class="s1">STOP SPAWNKILLING</span><span class="si">{U}</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">kill</span><span class="p">[</span><span class="s1">&#39;killer_nick&#39;</span><span class="p">])</span>

<span class="n">s</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="streak">
<h3>Streak<a class="headerlink" href="#streak" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># DPLib - Asynchronous bot framework for Digital Paint: Paintball 2 servers</span>
<span class="c1"># Copyright (C) 2017  Michał Rokita</span>
<span class="c1">#</span>
<span class="c1"># This program is free software: you can redistribute it and/or modify</span>
<span class="c1"># it under the terms of the GNU Affero General Public License as published by</span>
<span class="c1"># the Free Software Foundation, either version 3 of the License, or</span>
<span class="c1"># (at your option) any later version.</span>
<span class="c1">#</span>
<span class="c1"># This program is distributed in the hope that it will be useful,</span>
<span class="c1"># but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="c1"># MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="c1"># GNU Affero General Public License for more details.</span>
<span class="c1">#</span>
<span class="c1"># You should have received a copy of the GNU Affero General Public License</span>
<span class="c1"># along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>

<span class="kn">import</span> <span class="nn">asyncio</span>

<span class="kn">from</span> <span class="nn">dplib.server</span> <span class="k">import</span> <span class="n">Server</span>

<span class="n">s</span> <span class="o">=</span> <span class="n">Server</span><span class="p">(</span><span class="n">hostname</span><span class="o">=</span><span class="s1">&#39;127.0.0.1&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">27910</span><span class="p">,</span> <span class="n">logfile</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;C:\Games\Paintball2\pball\qconsole27910.log&#39;</span><span class="p">,</span> <span class="n">rcon_password</span><span class="o">=</span><span class="s1">&#39;hello&#39;</span><span class="p">)</span>


<span class="nd">@asyncio</span><span class="o">.</span><span class="n">coroutine</span>
<span class="k">def</span> <span class="nf">streak</span><span class="p">(</span><span class="n">killer_nick</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">killer_nick</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
        <span class="k">yield from</span> <span class="n">s</span><span class="o">.</span><span class="n">wait_for_elim</span><span class="p">(</span><span class="n">killer_nick</span><span class="o">=</span><span class="n">killer_nick</span><span class="p">)</span>


<span class="nd">@s</span><span class="o">.</span><span class="n">event</span>
<span class="k">def</span> <span class="nf">on_elim</span><span class="p">(</span><span class="n">killer_nick</span><span class="p">,</span> <span class="n">killer_weapon</span><span class="p">,</span> <span class="n">victim_nick</span><span class="p">,</span> <span class="n">victim_weapon</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">yield from</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">wait_for</span><span class="p">(</span><span class="n">streak</span><span class="p">(</span><span class="n">killer_nick</span><span class="p">),</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
        <span class="n">s</span><span class="o">.</span><span class="n">say</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{U}%s</span><span class="s1"> ZABUJCA!</span><span class="si">{U}</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">killer_nick</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">TimeoutError</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Timeout for &#39;</span><span class="o">+</span> <span class="n">killer_nick</span><span class="p">)</span>

<span class="n">s</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="server-manager">
<h3>Server manager<a class="headerlink" href="#server-manager" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># DPLib - Asynchronous bot framework for Digital Paint: Paintball 2 servers</span>
<span class="c1"># Copyright (C) 2017  Michał Rokita</span>
<span class="c1">#</span>
<span class="c1"># This program is free software: you can redistribute it and/or modify</span>
<span class="c1"># it under the terms of the GNU Affero General Public License as published by</span>
<span class="c1"># the Free Software Foundation, either version 3 of the License, or</span>
<span class="c1"># (at your option) any later version.</span>
<span class="c1">#</span>
<span class="c1"># This program is distributed in the hope that it will be useful,</span>
<span class="c1"># but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="c1"># MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="c1"># GNU Affero General Public License for more details.</span>
<span class="c1">#</span>
<span class="c1"># You should have received a copy of the GNU Affero General Public License</span>
<span class="c1"># along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>

<span class="kn">import</span> <span class="nn">asyncio</span>

<span class="kn">from</span> <span class="nn">dplib.server</span> <span class="k">import</span> <span class="n">Server</span>

<span class="n">s</span> <span class="o">=</span> <span class="n">Server</span><span class="p">(</span><span class="n">hostname</span><span class="o">=</span><span class="s1">&#39;127.0.0.1&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">27910</span><span class="p">,</span> <span class="n">logfile</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;C:\Games\Paintball2\pball\qconsole27910.log&#39;</span><span class="p">,</span> <span class="n">rcon_password</span><span class="o">=</span><span class="s1">&#39;hello&#39;</span><span class="p">)</span>


<span class="nd">@asyncio</span><span class="o">.</span><span class="n">coroutine</span>
<span class="k">def</span> <span class="nf">streak</span><span class="p">(</span><span class="n">killer_nick</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">killer_nick</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
        <span class="k">yield from</span> <span class="n">s</span><span class="o">.</span><span class="n">wait_for_elim</span><span class="p">(</span><span class="n">killer_nick</span><span class="o">=</span><span class="n">killer_nick</span><span class="p">)</span>


<span class="nd">@s</span><span class="o">.</span><span class="n">event</span>
<span class="k">def</span> <span class="nf">on_elim</span><span class="p">(</span><span class="n">killer_nick</span><span class="p">,</span> <span class="n">killer_weapon</span><span class="p">,</span> <span class="n">victim_nick</span><span class="p">,</span> <span class="n">victim_weapon</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">yield from</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">wait_for</span><span class="p">(</span><span class="n">streak</span><span class="p">(</span><span class="n">killer_nick</span><span class="p">),</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
        <span class="n">s</span><span class="o">.</span><span class="n">say</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{U}%s</span><span class="s1"> ZABUJCA!</span><span class="si">{U}</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">killer_nick</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">TimeoutError</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Timeout for &#39;</span><span class="o">+</span> <span class="n">killer_nick</span><span class="p">)</span>

<span class="n">s</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="includeme.html" class="btn btn-neutral float-right" title="README" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="includelicense.html" class="btn btn-neutral float-left" title="LICENSE" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017-2018, Michał Rokita

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>